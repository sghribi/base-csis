{% extends 'CSISEamBundle::layout.html.twig' %}

{% block csis_body %}

<div class="row">
  <div class="span12">
    {% include 'CSISEamBundle:Eam:flash.html.twig' %}
    {% include 'CSISEamBundle:Eam:mainflash.html.twig' %}

  <ul class="breadcrumb">
      <li><a href="{{ path('vitrine') }}">Vitrine</a> <span class="divider"><i class="icon icon-chevron-right"></i></span></li>
      <li class="active">{{ institution.name }}</li>
  </ul>

  </div>
</div>

<div class="row">
  <div class="span12">
    <div class="well">
      
      <div class="pull-left">
        <h4>Fiche de l'Etablissement : {{ institution.acronym }}</h4>
      </div>
      <div class="pull-right">
        <a href="{{ path('institution') }}" class="btn btn-default" data-toggle="tooltip" title="Retour à la liste des Etablissements">
          <i class="icon-list-alt"></i> Liste des établissements
        </a>
      </div>
      <br/>
      <p class="clearfix"></p>
      
      <div class="tabbable"> 
        <ul class="nav nav-tabs">
          <li class="active"><a href="#infos" data-toggle="tab">Informations</a></li>
          <li><a href="#laboratories" data-toggle="tab">Laboratoires associés</a></li>
        </ul>

        <div class="tab-content">
          <div class="tab-pane active" id="infos">
            {% include 'CSISEamBundle:Institution:profilCard.html.twig' %}
          </div>
          <div class="tab-pane" id="laboratories">
            <table class="table table-striped table-hover">               
              <thead>
                <tr>
                  <th>Acronym</th>
                  <th>Etablissement</th>
                  <th>Nom (FR)</th>
                  <th>Name (EN)</th>
                  <th>CSIS</th>
                  <th>Recherche</th>
                  <th>&nbsp;</th>
                </tr>
              </thead>

              <tbody id="tablebody">
              {# Affiche tous les laboratoires par ordre alphabétique #}
              {% for laboratory in institution.laboratories %}
                <tr>
                  <td>{{ laboratory.acronym }}</td> {# Acronym du labo #}
                  <td>{{ laboratory.institution.name }}</td> {# Nom francais du labo #}
                  <td>{{ laboratory.nameFr }}</td> {# Nom francais du labo #}
                  <td>{{ laboratory.nameEn }}</td> {# Nom francais du labo #}
                  <td>{% if laboratory.researchLaboratory=='0' %} Non {% else %} Oui {% endif %}</td>{# Nom francais du labo #}
                  <td><a href="{{ path('laboratory_show', { 'id': laboratory.id }) }}" class="icon-eye-open" data-toggle="tooltip" title="Afficher" ></a></td>
                </tr>
              {% else %}
                <tr>
                  <td colspan="7">
                    <strong>Il n'y a aucun laboratoire à afficher pour cet établissement !</strong><br />
                  </td>
                </tr>
              {% endfor %}                    
              </tbody>               
            </table>
          </div>
        </div>
      </div>
      
      {# Definition des bouttons #}
      {% if is_granted("ROLE_GEST_ESTAB") %}
        <div class="pull-right">
          <a class="btn btn-success" href="{{ path('institution_edit', { 'id': institution.id }) }}">
            <i class="icon-edit icon-white"></i> Éditer l'établissement
          </a>
          <a class="btn btn-info" href="{{ path('institution_credentials', { 'id': institution.id }) }}">
              <i class="icon-user icon-white"></i> Gérer les propriétaires
          </a>
          <a class="btn btn-danger" href="{{ path('institution_ask_delete', { 'id': institution.id }) }}">
            <i class="icon-trash icon-white"></i> Supprimer l'établissement
          </a>
        </div>
        <br />
      {% endif %}
    </div>
  </div>
</div>

{% endblock %}
